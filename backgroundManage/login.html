<!DOCTYPE html>
<html lang="zh-cn">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <meta name="renderer" content="webkit">
    <title>登录</title>
    <link rel="stylesheet" href="css/pintuer.css">
    <link rel="stylesheet" href="css/admin.css">
    <link rel="stylesheet" href="css/verify.css">
    <script src="js/jquery.js"></script>
    <!--<script src="js/verify.js"></script>-->
    <script src="js/pintuer.js"></script>
    <script src="js/tooltips.js"></script>
    <script src="js/config.js"></script>
    <script src="js/jquery.cookie.js"></script>
</head>
<style>
    .bg form{
        width: 400px;
        position: absolute;
        top: 50%;
        left:50%;
        transform: translate(-50%,-50%);
    }
    .container {
        position: absolute;
        top: 5%;
        right: 5%;
        height: 40px;
        width: 140px;
        z-index: 999;
    }
    *[data-animation="ripple"] {
        height: 100%;
        width: 100%;
        display: block;
        outline: none;
        color: #fff;
        text-transform: uppercase;
        background: linear-gradient(135deg, #e570e7 0%,#79f1fc 100%);
        box-sizing: border-box;
        text-align: center;
        line-height: 14px;
        font-family: roboto, helvetica;
        font-size: 16px;
        font-weight: 500;
        letter-spacing: 1px;
        text-decoration: none;
        box-shadow: 0 5px 3px rgba(0, 0, 0, 0.3);
        cursor: pointer;
        /*border-radius: 50px;*/
        -webkit-tap-highlight-color: transparent;
        border-radius: 5px;
    }

    *[data-animation="ripple"]:focus {
        outline: none;
    }

    *[data-animation="ripple"]::selection {
        background: transparent;
        pointer-events: none;
    }
</style>
<body>
<div class="bg">
    <div class="container">
        <a data-animation="ripple" style="line-height: 40px;" href="http://113.141.72.212:9295/index/index.html">返回主界面</a>
    </div>
    <form action="##" onsubmit="return false" method="post">
        <div class="panel loginbox">
            <div class="text-center margin-big padding-big-top"><h1>后台管理中心</h1></div>
            <div class="panel-body" style="padding:30px; padding-bottom:10px; padding-top:10px;">
                <div class="form-group">
                    <div class="field field-icon-right">
                        <input type="text" class="input input-big" name="name" placeholder="登录账号" data-validate="required:请填写账号" id="name"/>
                        <span class="icon icon-user margin-small"></span>
                    </div>
                </div>
                <div class="form-group">
                    <div class="field field-icon-right">
                        <input type="password" class="input input-big" name="password" placeholder="登录密码" data-validate="required:请填写密码" id="pass"/>
                        <span class="icon icon-key margin-small"></span>
                    </div>
                </div>
                <div class="form-group">
                    <div class="field">
                    <input type="text" id="checkCode" class="input input-big" name="code" placeholder="填写右侧的验证码" data-validate="required:请填写右侧的验证码" style="position:relative;"/>
                   <img src="##" alt="" width="100" height="32" id="UUID" class="passcode" style="height:43px;cursor:pointer;">
                    <div id="mpanel2" style="position:absolute;bottom:-5px;right:0;"></div>
                   </div>
               </div>
            </div>
            <div style="padding:30px;"><input style="text-align:center" id="submit" type="button" class="button button-block bg-main text-big input-big" value="登录"></div>
        </div>
    </form>
</div>
<script>
    window["tmripple"] =
        /******/ (function(modules) { // webpackBootstrap
        /******/ 	// The module cache
        /******/ 	var installedModules = {};
        /******/
        /******/ 	// The require function
        /******/ 	function __webpack_require__(moduleId) {
            /******/
            /******/ 		// Check if module is in cache
            /******/ 		if(installedModules[moduleId]) {
                /******/ 			return installedModules[moduleId].exports;
                /******/ 		}
            /******/ 		// Create a new module (and put it into the cache)
            /******/ 		var module = installedModules[moduleId] = {
                /******/ 			i: moduleId,
                /******/ 			l: false,
                /******/ 			exports: {}
                /******/ 		};
            /******/
            /******/ 		// Execute the module function
            /******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
            /******/
            /******/ 		// Flag the module as loaded
            /******/ 		module.l = true;
            /******/
            /******/ 		// Return the exports of the module
            /******/ 		return module.exports;
            /******/ 	}
        /******/
        /******/
        /******/ 	// expose the modules object (__webpack_modules__)
        /******/ 	__webpack_require__.m = modules;
        /******/
        /******/ 	// expose the module cache
        /******/ 	__webpack_require__.c = installedModules;
        /******/
        /******/ 	// define getter function for harmony exports
        /******/ 	__webpack_require__.d = function(exports, name, getter) {
            /******/ 		if(!__webpack_require__.o(exports, name)) {
                /******/ 			Object.defineProperty(exports, name, {
                    /******/ 				configurable: false,
                    /******/ 				enumerable: true,
                    /******/ 				get: getter
                    /******/ 			});
                /******/ 		}
            /******/ 	};
        /******/
        /******/ 	// getDefaultExport function for compatibility with non-harmony modules
        /******/ 	__webpack_require__.n = function(module) {
            /******/ 		var getter = module && module.__esModule ?
                /******/ 			function getDefault() { return module['default']; } :
                /******/ 			function getModuleExports() { return module; };
            /******/ 		__webpack_require__.d(getter, 'a', getter);
            /******/ 		return getter;
            /******/ 	};
        /******/
        /******/ 	// Object.prototype.hasOwnProperty.call
        /******/ 	__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };
        /******/
        /******/ 	// __webpack_public_path__
        /******/ 	__webpack_require__.p = "";
        /******/
        /******/ 	// Load entry module and return exports
        /******/ 	return __webpack_require__(__webpack_require__.s = 0);
        /******/ })
    /************************************************************************/
    /******/ ([
        /* 0 */
        /***/ (function(module, exports, __webpack_require__) {

            "use strict";


// Default Settings
            var settings = {
                area: "",
                color: "rgba(255, 255, 255, 0.4)",
                offsetEl: null,
                eventListener: "click",
                mouseMove: false
            };

            /**
             * @description Where the magic happens
             * @param {object} e
             * @param {string} rippleColor
             * @param {string} eventListener
             */
            function ripple(e, rippleColor, eventListener) {
                var clickedEl = e.currentTarget;
                var PageX = eventListener.match(/touch/) ? e.changedTouches[0].pageX : e.clientX;
                var PageY = eventListener.match(/touch/) ? e.changedTouches[0].pageY : e.clientY;
                var btnWidth = clickedEl.clientWidth;
                var el = clickedEl.getBoundingClientRect();
                var rippleOffset = settings.offsetEl ? settings.offsetEl.clientHeight : 0;
                var btnOffsetTop = el.top + rippleOffset;
                var btnOffsetLeft = el.left;
                var posMouseX = PageX;
                var posMouseY = PageY + rippleOffset;
                var rippleX = posMouseX - btnOffsetLeft;
                var rippleY = posMouseY - btnOffsetTop;

                var baseCSS = "\n          position: absolute;\n          width: " + btnWidth * 2 + "px;\n          height: " + btnWidth * 2 + "px;\n          border-radius: 50%;\n          transition: transform 700ms, opacity 700ms;\n          transition-timing-function: cubic-bezier(0.250, 0.460, 0.450, 0.940);\n          background: " + rippleColor + ";\n          background-position: center;\n          background-repeat: no-repeat;\n          background-size: 100%;\n          left: " + (rippleX - btnWidth) + "px;\n          top: " + (rippleY - btnWidth) + "px;\n          transform: scale(0);\n          pointer-events: none;\n      ";

                // Prepare the dom
                var rippleEffect = document.createElement("span");
                rippleEffect.style.cssText = baseCSS;

                // Add some css for prevent overflow errors
                clickedEl.style.overflow = "hidden";

                // Check if the element is not static because the ripple is in absolute
                if (window.getComputedStyle(clickedEl).position === "static") {
                    clickedEl.style.position = "relative";
                }

                // Check for the mousemove event
                if (settings.mouseMove) {
                    settings.mouseMove = false;
                    return;
                }

                clickedEl.appendChild(rippleEffect);

                // start animation
                requestAnimationFrame(function () {
                    rippleEffect.style.cssText = baseCSS + " transform: scale(1); opacity: 0;";
                });

                setTimeout(function () {
                    rippleEffect.remove();
                }, 700);
            }

            /**
             * @description Prevent ripple when scrolling (Mobile Only)
             * @param {string} eventListener
             */
            function onDrag(eventListener) {
                if (eventListener === "touchend") {
                    document.getElementsByTagName("body")[0].addEventListener("touchmove", function () {
                        settings.mouseMove = true;
                    });
                }
            }

            function attachRipple(els, rippleColor, eventListener) {
                for (var i = 0; i < els.length; i += 1) {
                    var currentBtn = els[i];
                    currentBtn.addEventListener(eventListener, function (e) {
                        return ripple(e, rippleColor, eventListener);
                    });
                }
            }

            function attachRippleToAttribute(area, rippleColor, eventListener) {
                var attributeEl = document.querySelectorAll(area + " [data-animation='ripple']");

                if (attributeEl.length > 0) {
                    attachRipple(attributeEl, rippleColor, eventListener);
                } else {
                    throw new Error('not found any element with data-animation="ripple"');
                }
            }

            function attachRippleToSelectors(selectors, rippleColor, eventListener) {
                if (selectors) {
                    var selectorsEl = document.querySelectorAll(selectors);
                } else {
                    throw new Error("You have to enter at least 1 selector");
                }

                if (selectorsEl.length > 0) {
                    attachRipple(selectorsEl, rippleColor, eventListener);
                } else {
                    console.warn("No element found with this selector: ", selectors);
                }
            }

            module.exports = {
                init: function init() {
                    var data = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};

                    try {
                        var area = settings.area,
                            color = settings.color,
                            offsetEl = settings.offsetEl,
                            eventListener = settings.eventListener;


                        area = data.area || area;
                        color = data.color || color;
                        offsetEl = data.offsetEl ? this.setOffsetEl(data.offsetEl) : offsetEl;
                        eventListener = data.eventListener || eventListener;

                        onDrag(eventListener);
                        attachRippleToAttribute(area, color, eventListener);
                    } catch (e) {
                        console.warn(e.message);
                    }
                },
                attachToSelectors: function attachToSelectors() {
                    var data = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};

                    try {
                        var elSetting = {
                            color: data.color || settings.color,
                            eventListener: data.eventListener || settings.eventListener
                        };
                        var color = elSetting.color,
                            eventListener = elSetting.eventListener;


                        attachRippleToSelectors(data.selectors, color, eventListener);
                    } catch (e) {
                        console.warn(e.message);
                    }
                },
                setOffsetEl: function setOffsetEl(el) {
                    settings.offsetEl = document.querySelector(el);
                },

                ripple: ripple
            };

            /***/ })
        /******/ ]);

    tmripple.init()
</script>
<script>
    $(document).ready(function(){
        var url=config.url;
        var mydate = new Date();
        var uuid = "code"+mydate.getDay()+ mydate.getHours()+ mydate.getMinutes()+mydate.getSeconds()+mydate.getMilliseconds();
        $("#UUID").attr("src",url+"/user/getcode?token="+uuid);
        function login() {
            var name = $("#name").val();
            var checkCode = $("#checkCode").val();
            var admin = $("#pass").val();
            if(checkCode!=""&&checkCode!=null&&name!=""&&name!=null&&admin!=""&&admin!=null){
                $.ajax({
                    type: "POST",//方法类型
                    dataType: "json",//预期服务器返回的数据类型
                    url:  url+"/user/login",//url
                    data: {"token":uuid,"checkCode":checkCode,"username":name,"pwd":admin},
                    success:function (data) {
                        if (data.code == 2000){
                            // localStorage.setItem("token",data.data);
                            /*cookie存储token*/
                            $.cookie('token', data.data);
                            getUserName(data.data);
                            show_msg('登录成功咯！  正在为您跳转...','index.html');
                        }else if(data.code==1009){
                            show_err_msg("验证码错误，请重新输入");
                            $("#UUID").attr("src",url+"/user/getcode?token="+uuid+"&id="+Math.random()*1000);
                            return false;
                        }else if(data.code==1005){
                            show_err_msg("账号或者密码错误，请重新输入");
                            return false;
                        }
                    },
                    error:function () {
                         return false;
                    }
                })
            }else{

            }
        }
       $('#UUID').on("click",function(){
            $("#UUID").attr("src",url+"/user/getcode?token="+uuid+"&id="+Math.random()*1000);
       })
        var time=0;
        $("#submit").click(function(){
            if (time == 0) {
                time = 2; //设定间隔时间（秒）
                //启动计时器，倒计时time秒后自动关闭计时器。
                var index = setInterval(function(){
                    time--;
                    if (time == 0) {
                        clearInterval(index);
                    }
                }, 1000);
                // alert('按钮事件被触发');
                login();
            }else{
                // alert('目前按钮事件不允许被触发');
            }
        })
        /*键盘回车事件*/
        document.onkeydown=function(event){
            let e=event||window.event;
            if(e && e.keyCode==13){
                login();
            }
        }
        /////////////////////////////////////////////////////////////////
        function getUserName(token){
            $.ajax({
                url:url+"/user/check/token",
                data:{"token":token},
                method:"post",
                beforeSend:function(request){
                    request.setRequestHeader("Authorization",token);
                    request.setRequestHeader("X-Requested-With","XMLHttpRequest");
                },
                dataType:"json",
                success:function(data){
                    if(data.code===2000){
                        var message=JSON.stringify(data.data);
                        // localStorage.setItem("message",message);
                        /*cookie存储登录信息*/
                        $.cookie('loginMessage', message);
                    }else{
                        location.href="login.html";
                    }
                }
            })
        }
        /*验证是否登录*/
        let token=$.cookie("token");
        $.ajax({
            url:url+"/user/check/token",
            data:{"token":token},
            method:"post",
            async:false,
            beforeSend:function(request){
                request.setRequestHeader("Authorization",token);
                request.setRequestHeader("X-Requested-With","XMLHttpRequest");
            },
            dataType:"json",
            success:function(data){
                if(data.code===2000){
                    // location.href="index.html";
                    show_msg("已登录,正在跳转至首页","index.html")
                }else if(data.code===3000){
                    return;
                }
            }
        })
    })
</script>
<!--<script type="text/javascript">
    //封装过期控制代码
    function set(key,value){
        var curTime = new Date().getTime();
        localStorage.setItem(key,JSON.stringify({data:value,time:curTime}));
    }
    function get(key,exp){
        var data = localStorage.getItem(key);
        var dataObj = JSON.parse(data);
        if (new Date().getTime() - dataObj.time>exp) {
            console.log('信息已过期');
            //alert("信息已过期")
        }else{
            //console.log("data="+dataObj.data);
            //console.log(JSON.parse(dataObj.data));
            var dataObjDatatoJson = JSON.parse(dataObj.data)
            return dataObjDatatoJson;
        }
    }
</script>
<script>
    window.onload = function(){
        var value = '{"name":"和派孔明","Age":"18","address":"陆家嘴金融城"}';
        set('information',value);
        var dataObjData=get('information',1000);//过期时间为1秒,正常情况下，你点击的时候已经过期
        //var dataObjData=get('information',1000*60);//过期时间为1分钟
        //var dataObjData=get('information',1000*60*60);//过期时间为1小时
        //var Obj=get('information',1000*60*60*24);//过期时间为24小时
        // var dataObjData=get('information',1000*60*60*24*7);//过期时间为1周
        // console.log(dataObjData || null);
        if (dataObjData!="" && dataObjData!=null) {
            console.log("姓名:"+dataObjData.name);
            console.log("年龄:"+dataObjData.Age);
            console.log("地址:"+dataObjData.address);
        }else{
            alert("获取的信息已经过期");
        }
    }
</script>-->
</body>
</html>